<!DOCTYPE html>
<html>
<head>
    <title>Genshin Abyss Tourney - Search</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-custom">
        <div class="container">
            <a class="navbar-brand" href="home.html">GITV</a>
            <div class="navbar-nav">
                <a class="nav-link" href="home.html">Home</a>
                <a class="nav-link" href="index.html">Stats</a>
                <a class="nav-link" href="tournaments.html">Tournaments</a>
                <a class="nav-link" href="news.html">News</a>
                <a class="nav-link" href="players.html">Players Profiles</a>
            </div>
            <form class="d-flex ms-auto" style="position: relative;">
                <input class="form-control me-2" type="search" id="globalSearch" placeholder="Search...">
                <button class="btn btn-outline-light" type="submit">Search</button>
                <div id="suggestions" class="suggestions"></div>
            </form>
        </div>
    </nav>
    <div class="container">
        <h1 class="text-center mt-4">Search Results</h1>
        <div id="searchResults"></div>
    </div>
    <script>
        const search = document.getElementById('globalSearch');
        const suggestions = document.getElementById('suggestions');
        const results = document.getElementById('searchResults');

        async function loadAllData() {
            const players = await fetch('players.json').then(res => res.json()).then(data => data.players).catch(() => []);
            const news = await fetch('news.json').then(res => res.json()).catch(() => []);
            const tournaments = await fetch('tournaments.json').then(res => res.json()).catch(() => []);
            return { players, news, tournaments };
        }

        search.addEventListener('input', async () => {
            const term = search.value.toLowerCase();
            suggestions.innerHTML = '';
            results.innerHTML = '';

            const { players, news, tournaments } = await loadAllData();

            // Players
            const playerMatches = players.filter(p => p.alias.toLowerCase().includes(term) || p.region.toLowerCase().includes(term));
            playerMatches.forEach(p => {
                const div = document.createElement('div');
                div.textContent = `Player: ${p.alias} (${p.region})`;
                div.addEventListener('click', () => {
                    window.location.href = `player.html?alias=${p.alias}`;
                });
                results.appendChild(div);
            });

            // News (placeholder)
            const newsMatches = news.filter(n => n.title?.toLowerCase().includes(term));
            newsMatches.forEach(n => {
                const div = document.createElement('div');
                div.textContent = `News: ${n.title}`;
                results.appendChild(div);
            });

            // Tournaments (placeholder)
            const tourneyMatches = tournaments.filter(t => t.name?.toLowerCase().includes(term));
            tourneyMatches.forEach(t => {
                const div = document.createElement('div');
                div.textContent = `Tournament: ${t.name}`;
                results.appendChild(div);
            });

            if (!playerMatches.length && !newsMatches.length && !tourneyMatches.length) {
                results.innerHTML = '<p>No results found.</p>';
            }
        });
    </script>
</body>
</html>